import{c as S,r as i,j as e,B as T,R as k,T as R}from"./index-Cb9AmbZ7.js";import{f as E}from"./firebase-YPPaOoNU.js";import{C as c,d,e as l,a as o,c as x,b as N,B}from"./card-BIPM_yue.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=S("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),_="https://diagpro-gw-3tbssksx-3tbssksx.uc.gateway.dev",w=_;async function $(){const r=await E();return r?{Authorization:`Bearer ${r}`}:{}}async function v(r,n={}){const t={"Content-Type":"application/json",...await $(),...n.headers||{}},a=await fetch(`${w}${r}`,{...n,headers:t,credentials:"omit"});if(!a.ok){const m=await a.text();throw new Error(`${a.status} ${m}`)}return await a.json()}class A{async get(n){try{return{data:await v(n),status:200}}catch(t){return{error:t instanceof Error?t.message:"Unknown error",status:500}}}async post(n,t){try{return{data:await v(n,{method:"POST",body:t?JSON.stringify(t):void 0}),status:200}}catch(a){return{error:a instanceof Error?a.message:"Unknown error",status:500}}}isUsingNewApi(){return!0}getBaseUrl(){return w}}const f=new A,U=()=>{const[r,n]=i.useState([]),[t,a]=i.useState([]),[m,b]=i.useState([]),[p,y]=i.useState(!1),u=async()=>{y(!0);try{const s=await f.get("/orders?limit=5"),j=await f.get("/email-logs?limit=5"),C=await f.get("/submissions?limit=5");a(s.data||[]),b(j.data||[]),n(C.data||[])}catch(s){console.error("Error fetching data:",s)}finally{y(!1)}};i.useEffect(()=>{u();const s=setInterval(u,1e4);return()=>clearInterval(s)},[]);const h=s=>{switch(s){case"paid":case"sent":return e.jsx(x,{className:"h-4 w-4 text-green-500"});case"pending":return e.jsx(N,{className:"h-4 w-4 text-yellow-500"});case"failed":return e.jsx(L,{className:"h-4 w-4 text-red-500"});default:return e.jsx(R,{className:"h-4 w-4 text-gray-500"})}},g=s=>{const j={paid:"default",sent:"default",pending:"secondary",failed:"destructive"}[s]||"outline";return e.jsx(B,{variant:j,children:s})};return e.jsxs("div",{className:"container mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Payment Flow Test Monitor"}),e.jsxs(T,{onClick:u,disabled:p,size:"sm",children:[e.jsx(k,{className:`h-4 w-4 mr-2 ${p?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(l,{children:"Recent Orders"})}),e.jsxs(o,{className:"space-y-3",children:[t.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:s.customer_email}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["$",(s.amount/100).toFixed(2)," â€¢ ",new Date(s.created_at).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h(s.status),g(s.status)]})]},s.id)),t.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No orders yet"})]})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(l,{children:"Email Logs"})}),e.jsxs(o,{className:"space-y-3",children:[m.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:s.to_email}),e.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleTimeString()}),s.error&&e.jsx("div",{className:"text-xs text-red-500 mt-1",children:s.error})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h(s.status),g(s.status)]})]},s.id)),m.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No emails yet"})]})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(l,{children:"Diagnostic Submissions"})}),e.jsxs(o,{className:"space-y-3",children:[r.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-sm",children:[s.make," ",s.model]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.full_name," â€¢ ",new Date(s.created_at).toLocaleTimeString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[h(s.payment_status),g(s.payment_status)]})]},s.id)),r.length===0&&e.jsx("div",{className:"text-center text-muted-foreground py-4",children:"No submissions yet"})]})]})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(l,{children:"ðŸš¦ Testing Status"})}),e.jsx(o,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(x,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Secrets Ready"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"All API keys configured"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(x,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Database Ready"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Tables configured"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(x,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Functions Ready"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Edge functions deployed"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx(N,{className:"h-8 w-8 text-blue-500 mx-auto mb-2"}),e.jsx("div",{className:"font-medium",children:"Ready for Test"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Submit diagnostic to test"})]})]})})]}),e.jsxs(c,{children:[e.jsx(d,{children:e.jsx(l,{children:"ðŸ“‹ Testing Instructions"})}),e.jsxs(o,{children:[e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm",children:[e.jsx("li",{children:"Submit a diagnostic form with test data (not your real vehicle)"}),e.jsx("li",{children:"Complete the Stripe payment ($4.99)"}),e.jsx("li",{children:"Monitor this page to see real-time updates"}),e.jsx("li",{children:"Check your email for the analysis report with PDF"}),e.jsx("li",{children:'Verify all statuses show as "paid" and "sent"'})]}),e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"font-medium text-yellow-800",children:"ðŸ’¡ Pro Tip"}),e.jsx("div",{className:"text-sm text-yellow-700",children:"This page auto-refreshes every 10 seconds. Watch for status changes during your test."})]})]})]})]})};export{U as default};
